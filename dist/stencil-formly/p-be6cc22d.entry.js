import{r as e,c as i,h as t}from"./p-6eaec69f.js";import{b as l,l as s}from"./p-fdd7e6e3.js";const n=class{constructor(t){e(this,t),this.customChange=i(this,"customChange",7),this.disabled=!1,this.templateOptions={},this.docs=[]}calendarHandler(e,i){this.docs=[...e]}async componentWillLoad(){this.value&&(this.docs=Array.from(this.value));let e=[];e.push(l("https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js")),e.push(l("https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js")),e.push(s("https://unpkg.com/filepond@^4/dist/filepond.css")),e.push(s("https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css")),e.push(l("https://unpkg.com/filepond@^4/dist/filepond.js")),await Promise.all(e),FilePond.registerPlugin(FilePondPluginImagePreview),FilePond.registerPlugin(FilePondPluginFileValidateType),FilePond.setOptions({name:"file",server:{url:"http://localhost:3333/api/files",process:{url:"/upload",method:"POST",withCredentials:!1,headers:{toto:"toto"},timeout:7e3,onload:e=>{if(console.log("response",e),1==(e=JSON.parse(e)).success&&e.thumb&&e.url){let i=[...this.docs,{thumb:e.thumb,url:e.url}];this.customChange.emit({value:i})}},onerror:null,ondata:null},fetch:null,revert:null}})}componentDidRender(){const e=document.querySelector('input[type="file"]'),i=FilePond.create(e,{acceptedFileTypes:["image/*","application/pdf"]});i.on("processfile",((e,t)=>{i.removeFile(t.id)}))}renderInput(){return t("input",{type:"file",multiple:!0})}removeDoc(e){this.docs.splice(e,1),this.customChange.emit({value:this.docs})}renderDocs(){if(this.docs.length>0)return console.log("render docs",JSON.stringify(this.docs)),t("div",{class:"df-docs-container"},this.docs.map(((e,i)=>t("div",null,t("img",{src:e.thumb,style:{"margin-left":"10px"}}),t("button",{class:"delete is-small df-is-required",onClick:()=>{console.log("this.docs",this.docs),this.removeDoc(i)}})))))}async componentWillRender(){var e,i;this.displayRequired=1==(null===(e=this.templateOptions)||void 0===e?void 0:e.required)&&0==(null===(i=this.docs)||void 0===i?void 0:i.length)}render(){return t("field-container",{templateOptions:this.templateOptions,displayRequired:this.displayRequired},this.renderInput())}static get watchers(){return{value:["calendarHandler"]}}};n.style=".filepond--item{width:calc(25% - 0.5em)}.df-docs-container{display:flex;flex-wrap:wrap;flex-direction:row;align-items:center}";export{n as field_docs}
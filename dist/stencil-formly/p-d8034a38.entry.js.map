{"version":3,"names":["FieldInput","async","promises","push","loadCss","loadScript","Promise","all","componentDidRender","console","log","this","refInput","instance","intlTelInput","initialCountry","addEventListener","renderInput","h","ref","el","disabled","class","_a","templateOptions","required","value","onInput","ev","isValidNumber","getNumber","length","customChange","emit","onClick","displayRequired","render"],"sources":["./src/components/dynamic-form/fields/field-phonenumber.tsx"],"sourcesContent":["import { Component, h, State, Prop, Event, EventEmitter } from '@stencil/core';\n\nimport { loadScript, loadCss, loadModule, loadNoModule } from '../../../utils/loadScript';\n\ndeclare var intlTelInput: any;\ndeclare var intlTelInputUtils: any;\n\n@Component({\n  tag: 'field-phonenumber',\n})\nexport class FieldInput {\n  @Prop() value: any;\n  @Prop() disabled = false;\n  @Prop() templateOptions: any = {};\n\n  @Event() customChange: EventEmitter<any>;\n\n  refInput;\n  instance;\n\n  displayRequired;\n\n  async componentWillLoad() {\n    let promises = [];\n\n    promises.push(loadCss('https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.16/css/intlTelInput.css'));\n\n    promises.push(loadScript('https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.16/js/intlTelInput.min.js'));\n\n    promises.push(loadScript('https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.16/js/utils.min.js'));\n\n    return Promise.all(promises);\n  }\n\n  componentDidRender() {\n    console.log('ref', this.refInput);\n    this.instance = intlTelInput(this.refInput, {\n      initialCountry: 'fr',\n    });\n\n    this.refInput.addEventListener('countrychange', function () {\n      console.log('countrychange');\n    });\n  }\n\n  renderInput() {\n    return [\n      <input\n        ref={el => (this.refInput = el as HTMLElement)}\n        disabled={this.disabled}\n        class={'input ' + (this.templateOptions?.required == true && !this.value ? ' df-is-required' : '')}\n        value={this.value}\n        onInput={(ev: any) => {\n          console.log('valid ? ' + this.instance.isValidNumber());\n\n          if (this.instance.isValidNumber()) {\n            this.value = this.instance.getNumber();\n            if (this.value.length > 0) {\n              this.customChange.emit({ value: this.value });\n            }\n          }\n        }}\n      ></input>,\n      <button\n        class=\"button\"\n        onClick={() => {\n          this.value = null;\n          this.customChange.emit({ value: this.value });\n        }}\n      >\n        X\n      </button>,\n    ];\n  }\n\n  async componentWillRender() {\n    this.displayRequired = this.templateOptions?.required == true && !this.value;\n  }\n\n  render() {\n    return (\n      <field-container templateOptions={this.templateOptions} displayRequired={this.displayRequired}>\n        {this.renderInput()}\n      </field-container>\n    );\n  }\n}\n"],"mappings":"mGAUaA,EAAU,M,uGAEF,M,qBACY,E,CAS/BC,0BACE,IAAIC,EAAW,GAEfA,EAASC,KAAKC,EAAQ,uFAEtBF,EAASC,KAAKE,EAAW,yFAEzBH,EAASC,KAAKE,EAAW,kFAEzB,OAAOC,QAAQC,IAAIL,E,CAGrBM,qBACEC,QAAQC,IAAI,MAAOC,KAAKC,UACxBD,KAAKE,SAAWC,aAAaH,KAAKC,SAAU,CAC1CG,eAAgB,OAGlBJ,KAAKC,SAASI,iBAAiB,iBAAiB,WAC9CP,QAAQC,IAAI,gB,IAIhBO,c,MACE,MAAO,CACLC,EAAA,SACEC,IAAKC,GAAOT,KAAKC,SAAWQ,EAC5BC,SAAUV,KAAKU,SACfC,MAAO,YAAYC,EAAAZ,KAAKa,mBAAe,MAAAD,SAAA,SAAAA,EAAEE,WAAY,OAASd,KAAKe,MAAQ,kBAAoB,IAC/FA,MAAOf,KAAKe,MACZC,QAAUC,IACRnB,QAAQC,IAAI,WAAaC,KAAKE,SAASgB,iBAEvC,GAAIlB,KAAKE,SAASgB,gBAAiB,CACjClB,KAAKe,MAAQf,KAAKE,SAASiB,YAC3B,GAAInB,KAAKe,MAAMK,OAAS,EAAG,CACzBpB,KAAKqB,aAAaC,KAAK,CAAEP,MAAOf,KAAKe,O,MAK7CR,EAAA,UACEI,MAAM,SACNY,QAAS,KACPvB,KAAKe,MAAQ,KACbf,KAAKqB,aAAaC,KAAK,CAAEP,MAAOf,KAAKe,OAAQ,GAC9C,K,CAOPzB,4B,MACEU,KAAKwB,kBAAkBZ,EAAAZ,KAAKa,mBAAe,MAAAD,SAAA,SAAAA,EAAEE,WAAY,OAASd,KAAKe,K,CAGzEU,SACE,OACElB,EAAA,mBAAiBM,gBAAiBb,KAAKa,gBAAiBW,gBAAiBxB,KAAKwB,iBAC3ExB,KAAKM,c"}